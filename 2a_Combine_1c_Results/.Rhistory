# Load necessary libraries
library(readxl) # handle multiple sheets xlsx files
library(openxlsx) # handle xlsx in general
library(dplyr) # to bind df
# Get and check the current working directory
directory <- getwd()
cat("Current working directory:\n")
print(directory)
# List files in the directory
all_files <- list.files(directory)
cat("Files in the directory:\n")
print(all_files)
# List of all XLSX files in the directory
files <- list.files(directory, pattern = "\\.xlsx$", full.names = TRUE)
cat("XLSX files found:\n")
print(files)
# Check if files were found
if (length(files) == 0) {
stop("No XLSX files found in the specified directory.")
}
# Get and check the current working directory
directory <- getwd()
cat("Current working directory:\n")
print(directory)
# List all 1c XLSX files in the directory
files <- list.files(directory, pattern = "\\_1c.xlsx$", full.names = TRUE)
cat("1c xlsx result files found:\n")
print(files)
# Check if files were found
if (length(files) == 0) {
stop("No 1c xlsx result files found in the current directory.")
}
# Determine the number of sheets in the first file
first_file_sheets <- excel_sheets(files[1])
###################################
# File: 2a_Combine_1c_Results
# Input: "Sample_XXX_1b.txt" is the output of step 1b, which contains the peak identification information of
#         each metabolite of interest of each sample.
#         "Sample_XXX.mzML" is the open-source mzML format of mass spectrometery experients result files, which could be easily
#         converted from each company's result files through MSConvert (part of ProteoWizard)
# Function: Extract the M0, M1, and M2 information plus any information that may contribute to measurement bias
#         from the mzML result files based on the metabolite peak identification information given in the 1b .txt files
# Output: "Sample_XXX_1c.xlsx" have two sheets: sheet1 contains the integrated information, and sheet2 contains data of each individual slices
# Usage: For first time usage, please install all library properly. Must tell the program
#         the sample name and mzML result sample names (if different), and the method mz range
# Next to Do: Manually check the output "Sample_XXX_1c.xlsx" with excel and see if the calculated M0, M1 and M2 ratio is close
#             to the theory predictions. If not, this indicates the Orbitrap measurement of MID indeed has a bias and would need step 2
#             coding to train and apply the bias correction models.
####################################
#####################################
# Load necessary libraries
library(readxl) # handle multiple sheets xlsx files
library(openxlsx) # handle xlsx in general
library(dplyr) # to bind df
# Get and check the current working directory
directory <- getwd()
cat("Current working directory:\n")
print(directory)
# List all 1c XLSX files in the directory
files <- list.files(directory, pattern = "\\_1c.xlsx$", full.names = TRUE)
cat("1c xlsx result files found:\n")
print(files)
# Check if files were found
if (length(files) == 0) {
stop("No 1c xlsx result files found in the current directory.")
}
# Determine the number of sheets in the first file
first_file_sheets <- excel_sheets(files[1])
num_sheets <- length(first_file_sheets)
# Print the sheet names found in the first file
cat("Sheet names in the first file:\n")
print(first_file_sheets)
source("C:/Users/zhenw/Marc Hellerstein Lab/Orbitrap_Paper/2a_Combine_1c_Results/2a_Combine_1c_Results.R", echo=TRUE)
